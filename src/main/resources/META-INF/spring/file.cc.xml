<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">


    <routeContext xmlns="http://camel.apache.org/schema/spring" id="file">

        <route id="edifact2xml" errorHandlerRef="deadLetterErrorHandler" autoStartup="true">
            <from uri="file:{{fs.root}}/edifact2xml.in/" />
            <process ref="edifact2xml" />
            <to uri="file:{{fs.root}}/edifact2xml.out/" />
        </route>

        <route id="xml2edifact" errorHandlerRef="deadLetterErrorHandler" autoStartup="true">
          <from uri="file:{{fs.root}}/xml2edifact.in/" />
          <process ref="xml2edifact" />
          <to uri="file:{{fs.root}}/xml2edifact.out/" />
        </route>


        <route id="xsltExtensionFunctionsTest" errorHandlerRef="deadLetterErrorHandler" autoStartup="true">
            <from uri="file:{{fs.root}}/xslt-test.in/" />
            <!-- <to uri="xslt-saxon:file:data/mappings/tests/extensionFunctions.xslt?saxonExtensionFunctions=#translate,#log" /> -->

            <to uri="xslt-saxon:file:///home/mickas/Work/mescedia-EDI-Server-github/mescedia-EDI-Server/data/mappings/tests/extensionFunctions.xslt?saxonExtensionFunctions=#translate,#log" />

            <to uri="file:{{fs.root}}/xslt-test.out/" />
        </route>



        <route id="demoRoutingSlip" errorHandlerRef="deadLetterErrorHandler" autoStartup="true">
            <from uri="file:{{fs.root}}/routingSlipIn/" />

            <setHeader name="X-MESCEDIA-RoutingSlipDemo">
                <!--
                 <simple>bean:org.mescedia.processors.Edifact2Xml§xslt:file:src/test/resources/files/test.mapping.xslt</simple>

                <simple>bean:org.mescedia.processors.Edifact2Xml§xslt-saxon:file:///home/mickas/Work/mescedia-EDI-Server-github/mescedia-EDI-Server/data/mappings/tests/extensionFunctions.xslt?saxonExtensionFunctions=#translate,#log"</simple>
                -->

                <simple>bean:org.mescedia.processors.Edifact2Xml§xslt-saxon:file:///home/mickas/Work/mescedia-EDI-Server-github/mescedia-EDI-Server/data/mappings/tests/extensionFunctions.xslt?saxonExtensionFunctions=#translate,#log </simple>
            </setHeader>

            <log message="processing routingSlip: ${header.X-MESCEDIA-RoutingSlipDemo}" />

            <routingSlip uriDelimiter="§" ignoreInvalidEndpoints="false">
                <header>X-MESCEDIA-RoutingSlipDemo</header>
            </routingSlip>

            <log message="header.Transaction-Id: ${header.Transaction-Id}" />

            <to uri="file:{{fs.root}}/routingSlipOut/?fileName=${date:now:yyyyMMddHHmmssSSS}-${header.Transaction-Id}" />
        </route>

    </routeContext>

</beans>
